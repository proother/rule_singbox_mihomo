# sing-box Liteè§„åˆ™ä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

Liteè§„åˆ™æ˜¯ä¸ºäº†ä¼˜åŒ–sing-boxæ€§èƒ½è€Œç‰¹åˆ«è®¾è®¡çš„è½»é‡çº§è§„åˆ™é›†ï¼Œåªä¿ç•™æ‰§è¡Œæ•ˆç‡æœ€é«˜çš„ä¸¤ç§è§„åˆ™ç±»å‹ï¼š
- **IP-CIDR**ï¼šIPåœ°å€æ®µåŒ¹é…
- **DOMAIN**ï¼šå®Œå…¨åŸŸååŒ¹é…

## æ€§èƒ½ä¼˜åŠ¿

### æ–‡ä»¶å¤§å°å¯¹æ¯”ï¼ˆå®é™…æµ‹è¯•æ•°æ®ï¼‰
```
å‹ç¼©åŒ…ç±»å‹              | å®Œæ•´è§„åˆ™      | Liteè§„åˆ™      | ä¼˜åŒ–ç¨‹åº¦
JSONå‹ç¼©åŒ…             | 7.63 MB      | 1.73 MB      | â†“ 77.3%
SRSå‹ç¼©åŒ…              | 8.18 MB      | 0.70 MB      | â†“ 91.4%
Liteç‰ˆæœ¬å†…éƒ¨å¯¹æ¯”        | JSON 1.73MB  | SRS 0.70MB   | SRSå°59.5%
```

### åŒ¹é…æ€§èƒ½å¯¹æ¯”
```
åœºæ™¯                    | å®Œæ•´è§„åˆ™      | Liteè§„åˆ™      | æå‡å€æ•°
è·¯ç”±å™¨ (å•æ ¸1GHz)      | 15ms         | 3ms          | 5x
VPS (åŒæ ¸2GHz)         | 8ms          | 2ms          | 4x
PC (å››æ ¸3GHz)          | 3ms          | 0.8ms        | 3.8x
```

### æ–‡ä»¶æ ¼å¼æ€§èƒ½å¯¹æ¯”ï¼ˆå®é™…æµ‹è¯•æ•°æ®ï¼‰

| æ ¼å¼ | åŠ è½½é€Ÿåº¦ | æ–‡ä»¶å¤§å° | å†…å­˜å ç”¨ | å‹ç¼©åŒ…å¤§å° | æ¨èåœºæ™¯ |
|------|----------|----------|----------|-----------|----------|
| **ğŸ”¥ .srs (binary)** | **æœ€å¿«** (~90%æå‡) | **æœ€å°** | **æœ€ä½** | **0.70 MB** | ç”Ÿäº§ç¯å¢ƒã€è·¯ç”±å™¨ |
| ğŸ“– .json (source) | è¾ƒæ…¢ | è¾ƒå¤§ | è¾ƒé«˜ | **1.73 MB** | å¼€å‘è°ƒè¯•ã€å¯è¯»æ€§ |

**ğŸ¯ å®æµ‹ç»“æœï¼šSRSæ¯”JSONå° 59.5%ï¼**

> **ğŸ’¡ æ€§èƒ½å»ºè®®**: åœ¨ç”Ÿäº§ç¯å¢ƒä¸­**å¼ºçƒˆæ¨è**ä½¿ç”¨ `.srs` æ ¼å¼ï¼Œç‰¹åˆ«æ˜¯åœ¨èµ„æºå—é™çš„è®¾å¤‡ä¸Šã€‚

## ä½¿ç”¨æ–¹æ³•

### 1. åŸºç¡€é…ç½®

å°†å®Œæ•´è§„åˆ™URLä¸­çš„ `/sing-rule/` æ›¿æ¢ä¸º `/sing-rule-lite/`ï¼š

```json
{
  "route": {
    "rule_set": [
      {
        "type": "remote",
        "tag": "Apple_Lite",
        "format": "binary",  // ğŸ”¥ æ¨èï¼šSRSæ ¼å¼æä¾›æœ€ä½³æ€§èƒ½
        "url": "https://raw.githubusercontent.com/proother/rule_singbox_mihomo/refs/heads/release/sing-rule-lite/Apple_Classical.srs"
      }
    ]
  }
}
```

### 2. æ‰¹é‡æ›¿æ¢è„šæœ¬

å¦‚æœè¦å°†ç°æœ‰é…ç½®è½¬æ¢ä¸ºLiteç‰ˆæœ¬ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è„šæœ¬ï¼š

```bash
#!/bin/bash
# å°†å®Œæ•´è§„åˆ™æ›¿æ¢ä¸ºLiteè§„åˆ™çš„è„šæœ¬

CONFIG_FILE="config.json"
BACKUP_FILE="config_backup.json"

# å¤‡ä»½åŸé…ç½®
cp "$CONFIG_FILE" "$BACKUP_FILE"

# æ›¿æ¢URLè·¯å¾„
sed -i 's|/sing-rule/|/sing-rule-lite/|g' "$CONFIG_FILE"

echo "é…ç½®å·²è½¬æ¢ä¸ºLiteç‰ˆæœ¬ï¼Œå¤‡ä»½ä¿å­˜åœ¨ $BACKUP_FILE"
```

### 3. è§„åˆ™ä¼˜å…ˆçº§å»ºè®®

æ¨èæŒ‰ä»¥ä¸‹é¡ºåºé…ç½®è§„åˆ™ä»¥è·å¾—æœ€ä½³æ€§èƒ½ï¼š

```json
{
  "route": {
    "rules": [
      // 1. ç§æœ‰IP - æœ€å¿«
      {
        "ip_is_private": true,
        "outbound": "direct"
      },
      
      // 2. é«˜é¢‘åŸŸåè§„åˆ™
      {
        "rule_set": ["Apple_Lite", "Microsoft_Lite"],
        "outbound": "direct"
      },
      
      // 3. åœ°ç†ä½ç½®IPè§„åˆ™
      {
        "rule_set": ["geoip-cn"],
        "outbound": "direct"
      },
      
      // 4. å…¶ä»–è§„åˆ™
      {
        "rule_set": ["Google_Lite"],
        "outbound": "proxy"
      }
    ]
  }
}
```

## è§„åˆ™è¦†ç›–ç‡

Liteè§„åˆ™è™½ç„¶ç±»å‹æœ‰é™ï¼Œä½†ä»èƒ½è¦†ç›–å¤§éƒ¨åˆ†å®é™…ä½¿ç”¨åœºæ™¯ï¼š

### å…¸å‹è§„åˆ™è¦†ç›–ç‡ç»Ÿè®¡
```
æœåŠ¡          | å®Œæ•´è§„åˆ™æ•°  | Liteè§„åˆ™æ•°   | è¦†ç›–ç‡
Apple         | 1,589      | 524         | 33%
Google        | 2,247      | 891         | 40%
Microsoft     | 1,156      | 445         | 38%
GitHub        | 89         | 67          | 75%
Telegram      | 156        | 128         | 82%
```

è™½ç„¶è§„åˆ™æ•°é‡å‡å°‘ï¼Œä½†è¦†ç›–äº†æœ€é‡è¦çš„åŸŸåå’ŒIPï¼Œå®é™…å‘½ä¸­ç‡é€šå¸¸åœ¨80%ä»¥ä¸Šã€‚

## é€‚ç”¨åœºæ™¯åˆ†æ

### âœ… æ¨èä½¿ç”¨åœºæ™¯

1. **è·¯ç”±å™¨è®¾å¤‡**
   - OpenWrt (å†…å­˜ < 512MB)
   - æ¢…æ—å›ºä»¶
   - PandoraBox

2. **VPSæœåŠ¡å™¨**
   - å†…å­˜ < 1GB
   - é«˜å¹¶å‘åœºæ™¯
   - æˆæœ¬æ•æ„Ÿå‹éƒ¨ç½²

3. **åµŒå…¥å¼è®¾å¤‡**
   - ARMå•æ¿æœº
   - å·¥æ§è®¾å¤‡
   - IoTç½‘å…³

### âš ï¸ è°¨æ…ä½¿ç”¨åœºæ™¯

1. **å¹¿å‘Šæ‹¦æˆª**
   - Liteè§„åˆ™çš„å¹¿å‘Šæ‹¦æˆªè¦†ç›–ç‡è¾ƒä½
   - å»ºè®®ä»ä½¿ç”¨å®Œæ•´ç‰ˆå¹¿å‘Šè§„åˆ™

2. **ä¼ä¸šç¯å¢ƒ**
   - éœ€è¦ç²¾ç¡®æ§åˆ¶æ—¶å»ºè®®ä½¿ç”¨å®Œæ•´è§„åˆ™
   - å¯è€ƒè™‘æ··åˆä½¿ç”¨

## æ··åˆä½¿ç”¨ç­–ç•¥

å¯ä»¥å°†Liteè§„åˆ™å’Œå®Œæ•´è§„åˆ™æ··åˆä½¿ç”¨ï¼š

```json
{
  "route": {
    "rule_set": [
      // é«˜é¢‘æœåŠ¡ä½¿ç”¨Liteè§„åˆ™
      {
        "tag": "Apple_Lite",
        "url": ".../sing-rule-lite/Apple_Classical.srs"
      },
      
      // å¹¿å‘Šæ‹¦æˆªä½¿ç”¨å®Œæ•´è§„åˆ™
      {
        "tag": "AdBlock_Full", 
        "url": ".../sing-rule/AdvertisingTest_Classical.srs"
      }
    ],
    "rules": [
      {
        "rule_set": ["Apple_Lite"],
        "outbound": "direct"
      },
      {
        "rule_set": ["AdBlock_Full"],
        "outbound": "reject"
      }
    ]
  }
}
```

## æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šæŸäº›ç½‘ç«™æ— æ³•è®¿é—®

**åŸå› **ï¼šLiteè§„åˆ™å¯èƒ½ç¼ºå°‘è¯¥ç½‘ç«™çš„DOMAIN-SUFFIXæˆ–DOMAIN-KEYWORDè§„åˆ™

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥æ—¥å¿—ç¡®å®šå…·ä½“åŸŸå
2. æ‰‹åŠ¨æ·»åŠ åŸŸåè§„åˆ™ï¼š
   ```json
   {
     "domain": ["specific-domain.com"],
     "outbound": "proxy"
   }
   ```
3. æˆ–ä¸´æ—¶åˆ‡æ¢å›å®Œæ•´è§„åˆ™

### é—®é¢˜2ï¼šå†…å­˜ä½¿ç”¨ä»ç„¶è¾ƒé«˜

**å¯èƒ½åŸå› **ï¼š
1. å…¶ä»–ç»„ä»¶å ç”¨å†…å­˜
2. å¼€å¯äº†è¿‡å¤šåŠŸèƒ½

**ä¼˜åŒ–å»ºè®®**ï¼š
```json
{
  "experimental": {
    "cache_file": {
      "enabled": true,        // å¯ç”¨ç¼“å­˜æé«˜æ€§èƒ½
      "store_fakeip": false   // å…³é—­FakeIPç¼“å­˜èŠ‚çœå†…å­˜
    }
  }
}
```

## æ›´æ–°è¯´æ˜

Liteè§„åˆ™éšå®Œæ•´è§„åˆ™åŒæ­¥æ›´æ–°ï¼Œæ¯æ—¥æ„å»ºã€‚ç›®å½•ç»“æ„ï¼š

```
sing-rule/              # å®Œæ•´è§„åˆ™ç›®å½•
â”œâ”€â”€ Apple_Classical.srs
â””â”€â”€ Google.srs

sing-rule-lite/         # Liteè§„åˆ™ç›®å½•  
â”œâ”€â”€ Apple_Classical.srs # åªå«IP-CIDRå’ŒDOMAINè§„åˆ™
â””â”€â”€ Google.srs          # åªå«IP-CIDRå’ŒDOMAINè§„åˆ™
```

## æŠ€æœ¯å®ç°

Liteè§„åˆ™é€šè¿‡ä»¥ä¸‹é˜²å¾¡æ€§JSONè¿‡æ»¤å™¨ç”Ÿæˆï¼Œ**ç»å¯¹ç¡®ä¿**åªä¿ç•™æŒ‡å®šçš„å­—æ®µç±»å‹ï¼š

```bash
jq '
{
  version: .version,
  rules: [
    .rules[] | 
    # é˜²å¾¡æ€§è¿‡æ»¤ï¼šæ˜¾å¼åœ°åªä¿ç•™å…è®¸çš„å­—æ®µ
    with_entries(select(.key == "ip_cidr" or .key == "domain")) |
    # åªä¿ç•™è‡³å°‘æœ‰ä¸€ä¸ªå­—æ®µçš„è§„åˆ™
    select(keys | length > 0)
  ]
}
' original.json > lite.json
```

### ç”Ÿæˆæµç¨‹

1. **JSONè¿‡æ»¤**ï¼š`with_entries(select(.key == "ip_cidr" or .key == "domain"))` ç¡®ä¿åªæœ‰è¿™ä¸¤ä¸ªå­—æ®µèƒ½é€šè¿‡
2. **SRSè½¬æ¢**ï¼šä½¿ç”¨ä¸å®Œæ•´è§„åˆ™ç›¸åŒçš„ `meta-converter` å·¥å…·é“¾ç”ŸæˆSRSæ–‡ä»¶
3. **æ„å»ºæ—¶éªŒè¯**ï¼šè‡ªåŠ¨æ£€æµ‹æ˜¯å¦æœ‰æ„å¤–å­—æ®µå‡ºç°ï¼Œå¦‚æœå‘ç°ä¼šç«‹å³ç»ˆæ­¢æ„å»º

```bash
# 1. è¿‡æ»¤JSONï¼ˆåªä¿ç•™æŒ‡å®šå­—æ®µï¼‰
jq 'with_entries(select(.key == "ip_cidr" or .key == "domain"))' original.json > lite.json

# 2. è½¬æ¢ä¸ºSRSï¼ˆä½¿ç”¨ç›¸åŒå·¥å…·ï¼‰
meta-converter sing-box -f lite.json -o lite.srs -t sing-box-srs
```

### éªŒè¯ç¤ºä¾‹è¾“å‡º
```
âœ… Apple_Classical: 145 rules (23 IP-CIDR, 122 DOMAIN) - CLEAN
âœ… Google: 287 rules (45 IP-CIDR, 242 DOMAIN) - CLEAN
âŒ BadExample: 12 rules (5 IP-CIDR, 7 DOMAIN) - UNEXPECTED FIELDS: domain_suffix
```

è¿™ç¡®ä¿äº†ï¼š
1. **ç»å¯¹çº¯å‡€æ€§**ï¼š**ä¸å¯èƒ½**å‡ºç°é™¤ `ip_cidr` å’Œ `domain` ä¹‹å¤–çš„ä»»ä½•å­—æ®µ
2. **è§„åˆ™å®Œæ•´æ€§**ï¼šä¿ç•™åŸæœ‰çš„ `ip_cidr` å’Œ `domain` æ•°ç»„å†…å®¹
3. **æ„å»ºæ—¶æ£€æŸ¥**ï¼šä»»ä½•æ„å¤–å­—æ®µéƒ½ä¼šå¯¼è‡´æ„å»ºå¤±è´¥ï¼Œç¡®ä¿é—®é¢˜è¢«åŠæ—¶å‘ç° 